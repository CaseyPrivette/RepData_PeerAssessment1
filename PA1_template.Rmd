---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---

This file will fork data from rdpeng's Github account, process the data into usable form and then answer several quesions. This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.  

The questions we will address are:
1. What is the average number of steps taken per day
2. What is the average daily activity pattern
3. Are their differences in activity patterns between weekdays and weekends


## Loading and preprocessing the data
I've forked the Github repo RepData_PeerAssessment1 from rdpeng to obtain the data. First, I'll unzip the file activity.zip and load the data into an R data frame named 'data' and take a quick peek at the file.

```{r loadingdata, cache=TRUE}
setwd("~/DataScienceCoursera/ReproRes/RepData_PeerAssessment1")
print(date())
unzip("activity.zip", exdir=".")
data <- read.csv("activity.csv", header=T)
summary(data)
```

```{r checkingstructure}
str(data)
```
There is not a lot preprocessing necessary to answer our first couple of questions. I'll convert the data column to date format. Other than that we appear to be ready to use the data. I do see that there are quite a bit of NA values for steps. We'll address that later in our analysis.  

```{r formattingdates}
data[,2] <- as.Date(data[,2], "%Y-%m-%d")
```

## What is mean total number of steps taken per day?

To create a summary of the total number of steps taken per day I'll load dplyr and use the group_by and summarise functions to create a new data frame totsteps.

```{r stepsperday, cache=TRUE, echo=FALSE, results='hide'}
library(dplyr)
totsteps <- data %>%
      group_by(date) %>%
      summarise(sum=sum(steps, na.rm=TRUE))
```
```{r showsteps}
head(totsteps)
```

Now I'll show the results on a histogram.

```{r totstepshistogram, cache=TRUE}
stephist <- hist(totsteps$sum,
                 breaks=5,
                 col="light blue",
                 main = "Frequency of Total Steps Per Day",
                 xlab = "Total Steps")
```

```{r meanandmedian, echo=FALSE}
mean <- mean(totsteps$sum)
median <- median(totsteps$sum)
```
###Mean and median number of steps
This subject took an average of **`r mean`** steps each day with a median of **`r median`** steps. This is many more steps than the average of 5,116 for an American - source: [*NY Tmes*](http://well.blogs.nytimes.com/2010/10/19/the-pedometer-test-americans-take-fewer-steps/?_r=0).  

## What is the average daily activity pattern?

Now I'll take a look the average number of steps across all days by summarizing the number of steps for each interval over all days again using the group_by and summarise functions in dplyr. I'll then plot the table in a time-series graph using the base plotting system in R.  
```{r avgstepsbyinterval, cache=TRUE}
intervalavg <- data %>%
      group_by(interval) %>%
      summarise(avg=mean(steps, na.rm=TRUE))

plot(intervalavg$interval,
     intervalavg$avg,
     type="l",
     col="purple",
     lwd=2,
     main="Average Steps For Each 5-Minute Interval",
     xlab="Average Steps",
     ylab="Interval")
```

```{r maxinterval, echo=FALSE}
max <- max(intervalavg$avg)
row <- intervalavg[intervalavg$avg == max,]
```
###What time do the most steps tend to occur?  
The maximum average steps (**`r max`**) occur at the **`r row$interval`** interval.  

## Imputing missing values
Now I'll address the NA values in the raw data. We'll take the averages we calculated for each 5-minute interval above and use those as an estimate of the missing values. I'll write a short for loop to replace the NA's.

```{r replaceNAs, cache=TRUE}
for (i in 1:nrow(data)) {
      if (is.na(data[i,1]) == TRUE) {
            data[i, 1] <- intervalavg[i,2]
      }
}
head(data)
```

## Are there differences in activity patterns between weekdays and weekends?
